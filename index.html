<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HC File Sniffer</title>
</head>
<body>
    <h2>Upload Your .hc File</h2>
    <input type="file" id="fileInput" accept=".hc">
    <h3>Extracted Config:</h3>
    <pre id="output"></pre>

    <script>
        document.getElementById("fileInput").addEventListener("change", function(event) {
            let file = event.target.files[0];
            if (!file) return;

            let reader = new FileReader();
            reader.onload = function(e) {
                let content = e.target.result;
                
                // Try Base64 decoding if the content is potentially Base64-encoded
                let decodedContent = tryBase64Decode(content);
                if (decodedContent) {
                    content = decodedContent;
                }

                try {
                    let parsedData = JSON.parse(content); // Attempt to parse as JSON
                    displayData(parsedData);
                } catch (error) {
                    document.getElementById("output").textContent = "Could not parse the HC file. It may need a different decoding method.";
                }
            };
            reader.readAsText(file);
        });

        function tryBase64Decode(content) {
            // Check if the content looks like Base64 (length and character set)
            const base64Regex = /^[A-Za-z0-9+/=]+$/;
            if (base64Regex.test(content) && content.length % 4 === 0) {
                return atob(content); // Decode Base64 content
            }
            return null; // Return null if not Base64
        }

        function displayData(data) {
            let output = `
[ > ] Expired Date : ${data.expiry || "Unknown"}
[ > ] SSH : ${data.ssh || "Not Found"}
[ > ] SNI : ${data.sni || "Not Found"}
[ > ] Public Key : ${data.public_key || "Not Found"}
[ > ] HC Version : ${data.version || "Unknown"}
[ > ] Tunnel Settings : ${data.tunnel || "Not Found"}
`;
            document.getElementById("output").textContent = output;
        }
    </script>
</body>
</html>